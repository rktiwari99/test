!function(l){"use strict";function i(){var e=0;l("#template-kit-sortable-container .templates").each(function(){l(this).find(".position_id").val(e),e++})}l(function(){var e=l("#template-kit-sortable-container");0<e.length&&(i(),e.sortable(),e.on("sortstop",function(e,t){i()}))}),l(document).on("click",".upload-image",function(e){e.preventDefault();var a=l(this).parents(".templates").first().data("template-id"),s=wp.media.frames.file_frame=wp.media({title:"Select or upload image",library:{type:"image"},button:{text:"Select"},multiple:!1});s.on("select",function(){var e=s.state().get("selection").first().toJSON(),t="",i=parseInt(window.template_kit_export.thumbnail_width);if(!e.sizes.tk_preview||e.sizes.tk_preview.width<300){if(!(e.sizes.full&&e.sizes.full.width<=i))return void alert("Sorry the selected image does not have a correct thumbnail size. Please upload a new screenshot image that is at least "+i+" pixels wide.");t=e.sizes.full.url}else t=e.sizes.tk_preview.url;l("div[data-template-id="+a+"]").find(".tk-preview-image-id").val(e.id),l("div[data-template-id="+a+"] .screenshot").css("backgroundImage","url( "+t+")")}),s.open()})}(jQuery);